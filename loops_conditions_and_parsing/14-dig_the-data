#!/usr/bin/env bash
# Group visitors by IP and HTTP status code, then display counts (desc).

awk '$1 ~ /^[0-9]+\.[0-9]+\.[0-9]+\.[0-9]+$/ && $9 ~ /^[0-9]{3}$/ {print $1, $9}' apache-access.log \
  | sort \
  | uniq -c \
  | sort -k1,1nr -k2,2 -k3,3 \
  | awk '{print $1, $2, $3}'
